---
lang: zh-CN
meta:
  - name: keywords
    content: 沈志勇,JavaScript,面试题,设计模式,教学,自学,策略模式
  - name: author
    content: 沈志勇,沈志勇说,shenzhiyong,szy1000
---

# JS设计模式-策略模式

> 策略模式：定义一系列的算法，把他们一个个封装起来，并让它们可以相互替换。 

## 场景
策略模式的应用场景有许多，比如：网吧会员的计算系统，还有电商的优惠方式等等。在这里，我就用公司旁边那家网吧的计费方式为事例进行解析。

网吧的计费规则是这样的：（网费为5块一小时）

* 普通VIP，8折优惠
* 白银VIP，6折优惠
* 黄金VIP，5折优惠

## 实现
我们很容易写下如下代码：

```javascript
function calcPrice(level, price) {
  if(level === 'VIP') {
    return price * 0.8
  }
  if(level === 'silverVIP') {
    return price * 0.6
  }
  if(level === 'goldVIP') {
    return price * 0.5
  }
  return price
}
calcPrice('VIP', 50)  		  // 返回 40
calcPrice('silverVIP', 50)  // 返回 30
```
我们来看一下上面的代码，总结一下有以下几个缺点：

*	if判断太多，影响函数的执行效率。（在这个函数，效率影响的可能没有那么明显）
* 如果我们再添加一种会员机制，比如：超级会员打4折。我们需要到calcPrice函数内部去修改，这个违反了开放-封闭原则
## 改进
对于第一个缺点，我们可以使用switch case这个语法糖进行改写一下，得到如下代码：

```javascript
function calcPrice(level, price) {
   switch (level) {
    case 'VIP':
      return price * 0.8
    case 'silverVIP':
      return price * 0.6
    case 'goldVIP':
      return price * 0.5
    default:
      return price
  }
}
```
对于第二个缺点，我们就需要今天的主角，策略模式去修改了

```javascript
var strategies = {
  'VIP': function (price) {
    return price * 0.8
  },
  'silverVIP': function (price) {
    return price * 0.6
  },
  'goldVIP': function (price) {
    return price * 0.5
  },
}
function calcPrice(level, price) {
    return strategies[level](price)
}

console.log(calcPrice('VIP', 50)) // 40
```











<contact></contact>


